{"ast":null,"code":"import { global, isBrowser } from '../utils/globals';\nvar _parseImageNode = global._parseImageNode;\nvar IMAGE_SUPPORTED = typeof Image !== 'undefined';\nvar IMAGE_BITMAP_SUPPORTED = typeof ImageBitmap !== 'undefined';\nvar NODE_IMAGE_SUPPORTED = Boolean(_parseImageNode);\nexport function isImageTypeSupported(type) {\n  switch (type) {\n    case 'auto':\n      return IMAGE_BITMAP_SUPPORTED || IMAGE_SUPPORTED || NODE_IMAGE_SUPPORTED;\n\n    case 'imagebitmap':\n      return IMAGE_BITMAP_SUPPORTED;\n\n    case 'html':\n    case 'image':\n      return IMAGE_SUPPORTED;\n\n    case 'ndarray':\n    case 'data':\n      return isBrowser ? true : NODE_IMAGE_SUPPORTED;\n\n    default:\n      throw new Error(\"@loaders.gl/images: image \".concat(type, \" not supported in this environment\"));\n  }\n}\nexport function getDefaultImageType() {\n  if (isImageTypeSupported('image')) {\n    return 'image';\n  }\n\n  if (isImageTypeSupported('imagebitmap')) {\n    return 'imagebitmap';\n  }\n\n  if (isImageTypeSupported('data')) {\n    return 'data';\n  }\n\n  throw new Error(\"Install '@loaders.gl/polyfills' to parse images under Node.js\");\n}","map":{"version":3,"sources":["../../../../src/lib/parsed-image-api/image-type.js"],"names":["_parseImageNode","global","IMAGE_SUPPORTED","IMAGE_BITMAP_SUPPORTED","NODE_IMAGE_SUPPORTED","Boolean","isBrowser","isImageTypeSupported"],"mappings":"AACA,SAAA,MAAA,EAAA,SAAA,QAAA,kBAAA;IAGOA,e,GAAmBC,M,CAAnBD,e;AAEP,IAAME,eAAe,GAAG,OAAA,KAAA,KAAxB,WAAA;AACA,IAAMC,sBAAsB,GAAG,OAAA,WAAA,KAA/B,WAAA;AACA,IAAMC,oBAAoB,GAAGC,OAAO,CAApC,eAAoC,CAApC;AAGA,OAAO,SAAA,oBAAA,CAAA,IAAA,EAAoC;AACzC,UAAA,IAAA;AACE,SAAA,MAAA;AAEE,aAAOF,sBAAsB,IAAtBA,eAAAA,IAAP,oBAAA;;AAEF,SAAA,aAAA;AACE,aAAA,sBAAA;;AAEF,SAAA,MAAA;AAEA,SAAA,OAAA;AACE,aAAA,eAAA;;AAEF,SAAA,SAAA;AAEA,SAAA,MAAA;AACE,aAAOG,SAAS,GAAA,IAAA,GAAhB,oBAAA;;AAEF;AACE,YAAM,IAAA,KAAA,CAAA,6BAAA,MAAA,CAAA,IAAA,EAAN,oCAAM,CAAA,CAAN;AAnBJ;AAqBD;AAGD,OAAO,SAAA,mBAAA,GAA+B;AAEpC,MAAIC,oBAAoB,CAAxB,OAAwB,CAAxB,EAAmC;AACjC,WAAA,OAAA;AACD;;AACD,MAAIA,oBAAoB,CAAxB,aAAwB,CAAxB,EAAyC;AACvC,WAAA,aAAA;AACD;;AACD,MAAIA,oBAAoB,CAAxB,MAAwB,CAAxB,EAAkC;AAChC,WAAA,MAAA;AACD;;AAGD,QAAM,IAAA,KAAA,CAAN,+DAAM,CAAN;AACD","sourcesContent":["/* global ImageBitmap, Image */\nimport {global, isBrowser} from '../utils/globals';\n\n// @ts-ignore TS2339: Property does not exist on type\nconst {_parseImageNode} = global;\n\nconst IMAGE_SUPPORTED = typeof Image !== 'undefined'; // NOTE: \"false\" positives if jsdom is installed\nconst IMAGE_BITMAP_SUPPORTED = typeof ImageBitmap !== 'undefined';\nconst NODE_IMAGE_SUPPORTED = Boolean(_parseImageNode);\n\n// Checks if a loaders.gl image type is supported\nexport function isImageTypeSupported(type) {\n  switch (type) {\n    case 'auto':\n      // Should only ever be false in Node.js, if polyfills have not been installed...\n      return IMAGE_BITMAP_SUPPORTED || IMAGE_SUPPORTED || NODE_IMAGE_SUPPORTED;\n\n    case 'imagebitmap':\n      return IMAGE_BITMAP_SUPPORTED;\n\n    case 'html': // type `html` is deprecated, use `image`\n    // eslint-disable-next-line no-fallthrough\n    case 'image':\n      return IMAGE_SUPPORTED;\n\n    case 'ndarray': // type `ndarray` is deprecated, use 'data'\n    // eslint-disable-next-line no-fallthrough\n    case 'data':\n      return isBrowser ? true : NODE_IMAGE_SUPPORTED;\n\n    default:\n      throw new Error(`@loaders.gl/images: image ${type} not supported in this environment`);\n  }\n}\n\n// Returns the best loaders.gl image type supported on current run-time environment\nexport function getDefaultImageType() {\n  // TODO - switch order... we want to return imagebitmap by default\n  if (isImageTypeSupported('image')) {\n    return 'image';\n  }\n  if (isImageTypeSupported('imagebitmap')) {\n    return 'imagebitmap';\n  }\n  if (isImageTypeSupported('data')) {\n    return 'data';\n  }\n\n  // This should only happen in Node.js\n  throw new Error(`Install '@loaders.gl/polyfills' to parse images under Node.js`);\n}\n"]},"metadata":{},"sourceType":"module"}