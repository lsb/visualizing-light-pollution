{"ast":null,"code":"import _construct from \"@babel/runtime/helpers/esm/construct\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport { getTypedArrayFromGLType } from '../webgl-utils';\nimport { checkProps, assert } from '../utils';\nvar DEFAULT_ACCESSOR_VALUES = {\n  offset: 0,\n  stride: 0,\n  type: 5126,\n  size: 1,\n  divisor: 0,\n  normalized: false,\n  integer: false\n};\nvar PROP_CHECKS = {\n  deprecatedProps: {\n    instanced: 'divisor',\n    isInstanced: 'divisor'\n  }\n};\n\nvar Accessor = function () {\n  _createClass(Accessor, null, [{\n    key: \"getBytesPerElement\",\n    value: function getBytesPerElement(accessor) {\n      var ArrayType = getTypedArrayFromGLType(accessor.type || 5126);\n      return ArrayType.BYTES_PER_ELEMENT;\n    }\n  }, {\n    key: \"getBytesPerVertex\",\n    value: function getBytesPerVertex(accessor) {\n      assert(accessor.size);\n      var ArrayType = getTypedArrayFromGLType(accessor.type || 5126);\n      return ArrayType.BYTES_PER_ELEMENT * accessor.size;\n    }\n  }, {\n    key: \"resolve\",\n    value: function resolve() {\n      for (var _len = arguments.length, accessors = new Array(_len), _key = 0; _key < _len; _key++) {\n        accessors[_key] = arguments[_key];\n      }\n\n      return _construct(Accessor, [DEFAULT_ACCESSOR_VALUES].concat(accessors));\n    }\n  }]);\n\n  function Accessor() {\n    var _this = this;\n\n    _classCallCheck(this, Accessor);\n\n    for (var _len2 = arguments.length, accessors = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      accessors[_key2] = arguments[_key2];\n    }\n\n    accessors.forEach(function (accessor) {\n      return _this._assign(accessor);\n    });\n    Object.freeze(this);\n  }\n\n  _createClass(Accessor, [{\n    key: \"toString\",\n    value: function toString() {\n      return JSON.stringify(this);\n    }\n  }, {\n    key: \"_assign\",\n    value: function _assign() {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      props = checkProps('Accessor', props, PROP_CHECKS);\n\n      if (props.type !== undefined) {\n        this.type = props.type;\n\n        if (props.type === 5124 || props.type === 5125) {\n          this.integer = true;\n        }\n      }\n\n      if (props.size !== undefined) {\n        this.size = props.size;\n      }\n\n      if (props.offset !== undefined) {\n        this.offset = props.offset;\n      }\n\n      if (props.stride !== undefined) {\n        this.stride = props.stride;\n      }\n\n      if (props.normalized !== undefined) {\n        this.normalized = props.normalized;\n      }\n\n      if (props.integer !== undefined) {\n        this.integer = props.integer;\n      }\n\n      if (props.divisor !== undefined) {\n        this.divisor = props.divisor;\n      }\n\n      if (props.buffer !== undefined) {\n        this.buffer = props.buffer;\n      }\n\n      if (props.index !== undefined) {\n        if (typeof index === 'boolean') {\n          this.index = props.index ? 1 : 0;\n        } else {\n          this.index = props.index;\n        }\n      }\n\n      if (props.instanced !== undefined) {\n        this.divisor = props.instanced ? 1 : 0;\n      }\n\n      if (props.isInstanced !== undefined) {\n        this.divisor = props.isInstanced ? 1 : 0;\n      }\n\n      return this;\n    }\n  }, {\n    key: \"BYTES_PER_ELEMENT\",\n    get: function get() {\n      return Accessor.getBytesPerElement(this);\n    }\n  }, {\n    key: \"BYTES_PER_VERTEX\",\n    get: function get() {\n      return Accessor.getBytesPerVertex(this);\n    }\n  }]);\n\n  return Accessor;\n}();\n\nexport { Accessor as default };\nexport { DEFAULT_ACCESSOR_VALUES };","map":{"version":3,"sources":["../../../src/classes/accessor.js"],"names":["DEFAULT_ACCESSOR_VALUES","offset","stride","type","size","divisor","normalized","integer","PROP_CHECKS","deprecatedProps","instanced","isInstanced","Accessor","accessor","ArrayType","getTypedArrayFromGLType","assert","accessors","Object","JSON","props","checkProps"],"mappings":"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","sourcesContent":["import GL from '@luma.gl/constants';\nimport {getTypedArrayFromGLType} from '../webgl-utils';\nimport {checkProps, assert} from '../utils';\n\nconst DEFAULT_ACCESSOR_VALUES = {\n  offset: 0,\n  stride: 0,\n  type: GL.FLOAT,\n  size: 1,\n  divisor: 0,\n  normalized: false,\n  integer: false\n};\n\nconst PROP_CHECKS = {\n  deprecatedProps: {\n    instanced: 'divisor',\n    isInstanced: 'divisor'\n  }\n};\n\nexport default class Accessor {\n  static getBytesPerElement(accessor) {\n    // TODO: using `FLOAT` when type is not specified,\n    // ensure this assumption is valid or force API to specify type.\n    const ArrayType = getTypedArrayFromGLType(accessor.type || GL.FLOAT);\n    return ArrayType.BYTES_PER_ELEMENT;\n  }\n\n  static getBytesPerVertex(accessor) {\n    assert(accessor.size);\n    // TODO: using `FLOAT` when type is not specified,\n    // ensure this assumption is valid or force API to specify type.\n    const ArrayType = getTypedArrayFromGLType(accessor.type || GL.FLOAT);\n    return ArrayType.BYTES_PER_ELEMENT * accessor.size;\n  }\n\n  // Combines (merges) a list of accessors. On top of default values\n  // Usually [programAccessor, bufferAccessor, appAccessor]\n  // All props will be set in the returned object.\n  // TODO check for conflicts between values in the supplied accessors\n  static resolve(...accessors) {\n    return new Accessor(...[DEFAULT_ACCESSOR_VALUES, ...accessors]); // Default values\n  }\n\n  constructor(...accessors) {\n    accessors.forEach(accessor => this._assign(accessor)); // Merge in sequence\n    Object.freeze(this);\n  }\n\n  toString() {\n    return JSON.stringify(this);\n  }\n\n  // ACCESSORS\n\n  // TODO - remove>\n  get BYTES_PER_ELEMENT() {\n    return Accessor.getBytesPerElement(this);\n  }\n\n  get BYTES_PER_VERTEX() {\n    return Accessor.getBytesPerVertex(this);\n  }\n\n  // PRIVATE\n\n  // eslint-disable-next-line complexity, max-statements\n  _assign(props = {}) {\n    props = checkProps('Accessor', props, PROP_CHECKS);\n\n    if (props.type !== undefined) {\n      this.type = props.type;\n\n      // Auto-deduce integer type?\n      if (props.type === GL.INT || props.type === GL.UNSIGNED_INT) {\n        this.integer = true;\n      }\n    }\n    if (props.size !== undefined) {\n      this.size = props.size;\n    }\n    if (props.offset !== undefined) {\n      this.offset = props.offset;\n    }\n    if (props.stride !== undefined) {\n      this.stride = props.stride;\n    }\n    if (props.normalized !== undefined) {\n      this.normalized = props.normalized;\n    }\n    if (props.integer !== undefined) {\n      this.integer = props.integer;\n    }\n\n    // INSTANCE DIVISOR\n    if (props.divisor !== undefined) {\n      this.divisor = props.divisor;\n    }\n\n    // Buffer is optional\n    if (props.buffer !== undefined) {\n      this.buffer = props.buffer;\n    }\n\n    // The binding index (for binding e.g. Transform feedbacks and Uniform buffers)\n    // TODO - should this be part of accessor?\n    if (props.index !== undefined) {\n      if (typeof index === 'boolean') {\n        this.index = props.index ? 1 : 0;\n      } else {\n        this.index = props.index;\n      }\n    }\n\n    // DEPRECATED\n    if (props.instanced !== undefined) {\n      this.divisor = props.instanced ? 1 : 0;\n    }\n    if (props.isInstanced !== undefined) {\n      this.divisor = props.isInstanced ? 1 : 0;\n    }\n\n    return this;\n  }\n}\n\n// TEST EXPORTS\nexport {DEFAULT_ACCESSOR_VALUES};\n"]},"metadata":{},"sourceType":"module"}