{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport { ClipSpace, withParameters, clear } from '@luma.gl/core';\nimport Pass from './pass';\n\nvar ScreenPass = function (_Pass) {\n  _inherits(ScreenPass, _Pass);\n\n  function ScreenPass(gl) {\n    var _this;\n\n    var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, ScreenPass);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ScreenPass).call(this, gl, props));\n    var module = props.module,\n        fs = props.fs,\n        id = props.id;\n    _this.model = new ClipSpace(gl, {\n      id: id,\n      fs: fs,\n      modules: [module]\n    });\n    return _this;\n  }\n\n  _createClass(ScreenPass, [{\n    key: \"render\",\n    value: function render(params) {\n      var _this2 = this;\n\n      var gl = this.gl;\n      withParameters(gl, {\n        framebuffer: params.outputBuffer,\n        clearColor: [0, 0, 0, 0]\n      }, function () {\n        return _this2._renderPass(gl, params);\n      });\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      this.model[\"delete\"]();\n      this.model = null;\n    }\n  }, {\n    key: \"_renderPass\",\n    value: function _renderPass(gl, _ref) {\n      var inputBuffer = _ref.inputBuffer,\n          outputBuffer = _ref.outputBuffer;\n      clear(gl, {\n        color: true\n      });\n      this.model.draw({\n        moduleSettings: this.props.moduleSettings,\n        uniforms: {\n          texture: inputBuffer,\n          texSize: [inputBuffer.width, inputBuffer.height]\n        },\n        parameters: {\n          depthWrite: false,\n          depthTest: false\n        }\n      });\n    }\n  }]);\n\n  return ScreenPass;\n}(Pass);\n\nexport { ScreenPass as default };","map":{"version":3,"sources":["../../../src/passes/screen-pass.js"],"names":["ScreenPass","Pass","props","module","fs","id","modules","params","gl","withParameters","framebuffer","clearColor","inputBuffer","outputBuffer","clear","color","moduleSettings","uniforms","texture","texSize","parameters","depthWrite","depthTest"],"mappings":";;;;;AAMA,SAAA,SAAA,EAAA,cAAA,EAAA,KAAA,QAAA,eAAA;AACA,OAAA,IAAA,MAAA,QAAA;;IAEqBA,U;;;AACnB,WAAA,UAAA,CAAA,EAAA,EAA4B;AAAA,QAAA,KAAA;;AAAA,QAAZE,KAAY,GAAA,SAAA,CAAA,MAAA,GAAA,CAAA,IAAA,SAAA,CAAA,CAAA,CAAA,KAAA,SAAA,GAAA,SAAA,CAAA,CAAA,CAAA,GAAJ,EAAI;;AAAA,IAAA,eAAA,CAAA,IAAA,EAAA,UAAA,CAAA;;AAC1B,IAAA,KAAA,GAAA,0BAAA,CAAA,IAAA,EAAA,eAAA,CAAA,UAAA,CAAA,CAAA,IAAA,CAAA,IAAA,EAAA,EAAA,EAAA,KAAA,CAAA,CAAA;AAD0B,QAEnBC,MAFmB,GAEDD,KAFC,CAAA,MAAA;AAAA,QAEXE,EAFW,GAEDF,KAFC,CAAA,EAAA;AAAA,QAEPG,EAFO,GAEDH,KAFC,CAAA,EAAA;AAG1B,IAAA,KAAA,CAAA,KAAA,GAAa,IAAA,SAAA,CAAA,EAAA,EAAkB;AAACG,MAAAA,EAAE,EAAH,EAAA;AAAKD,MAAAA,EAAE,EAAP,EAAA;AAASE,MAAAA,OAAO,EAAE,CAAA,MAAA;AAAlB,KAAlB,CAAb;AAH0B,WAAA,KAAA;AAI3B;;;;2BAEMC,M,EAAQ;AAAA,UAAA,MAAA,GAAA,IAAA;;AACb,UAAMC,EAAE,GAAG,KAAX,EAAA;AAEAC,MAAAA,cAAc,CAAA,EAAA,EAAK;AAACC,QAAAA,WAAW,EAAEH,MAAM,CAApB,YAAA;AAAmCI,QAAAA,UAAU,EAAE,CAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA;AAA/C,OAAL,EAAmE,YAAA;AAAA,eAC/E,MAAI,CAAJ,WAAA,CAAA,EAAA,EAD+E,MAC/E,CAD+E;AAAjFF,OAAc,CAAdA;AAGD;;;8BAEQ;AACP,WAAA,KAAA,CAAA,QAAA;AACA,WAAA,KAAA,GAAA,IAAA;AACD;;;gCAUWD,E,QAAiC;AAAA,UAA5BI,WAA4B,GAAA,IAAA,CAA5BA,WAA4B;AAAA,UAAfC,YAAe,GAAA,IAAA,CAAfA,YAAe;AAC3CC,MAAAA,KAAK,CAAA,EAAA,EAAK;AAACC,QAAAA,KAAK,EAAE;AAAR,OAAL,CAALD;AACA,WAAA,KAAA,CAAA,IAAA,CAAgB;AACdE,QAAAA,cAAc,EAAE,KAAA,KAAA,CADF,cAAA;AAEdC,QAAAA,QAAQ,EAAE;AACRC,UAAAA,OAAO,EADC,WAAA;AAERC,UAAAA,OAAO,EAAE,CAACP,WAAW,CAAZ,KAAA,EAAoBA,WAAW,CAA/B,MAAA;AAFD,SAFI;AAMdQ,QAAAA,UAAU,EAAE;AACVC,UAAAA,UAAU,EADA,KAAA;AAEVC,UAAAA,SAAS,EAAE;AAFD;AANE,OAAhB;AAWD;;;;EAzCqCrB,I;;SAAnBD,U","sourcesContent":["//\n// A base render pass.\n//\n// Attribution: This class and the multipass system were inspired by\n// the THREE.js EffectComposer and *Pass classes\n\nimport {ClipSpace, withParameters, clear} from '@luma.gl/core';\nimport Pass from './pass';\n\nexport default class ScreenPass extends Pass {\n  constructor(gl, props = {}) {\n    super(gl, props);\n    const {module, fs, id} = props;\n    this.model = new ClipSpace(gl, {id, fs, modules: [module]});\n  }\n\n  render(params) {\n    const gl = this.gl;\n\n    withParameters(gl, {framebuffer: params.outputBuffer, clearColor: [0, 0, 0, 0]}, () =>\n      this._renderPass(gl, params)\n    );\n  }\n\n  delete() {\n    this.model.delete();\n    this.model = null;\n  }\n\n  // Private methods\n\n  /**\n   * Renders the pass.\n   * This is an abstract method that should be overridden.\n   * @param {Framebuffer} inputBuffer - Frame buffer that contains the result of the previous pass\n   * @param {Framebuffer} outputBuffer - Frame buffer that serves as the output render target\n   */\n  _renderPass(gl, {inputBuffer, outputBuffer}) {\n    clear(gl, {color: true});\n    this.model.draw({\n      moduleSettings: this.props.moduleSettings,\n      uniforms: {\n        texture: inputBuffer,\n        texSize: [inputBuffer.width, inputBuffer.height]\n      },\n      parameters: {\n        depthWrite: false,\n        depthTest: false\n      }\n    });\n  }\n}\n"]},"metadata":{},"sourceType":"module"}