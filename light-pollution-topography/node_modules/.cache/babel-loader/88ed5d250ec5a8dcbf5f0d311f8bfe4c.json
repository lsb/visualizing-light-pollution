{"ast":null,"code":"var _jsxFileName = \"/home/lsb/wikidatageo/dark-sky-vacations/src/App.js\";\nimport React from 'react';\nimport './App.css';\nimport DeckGL from '@deck.gl/react';\nimport { TerrainLayer, TileLayer } from '@deck.gl/geo-layers';\nimport { BitmapLayer } from '@deck.gl/layers';\nconst bitmapLayerDefaults = {\n  wrapLongitude: true,\n  renderSubLayers: props => new BitmapLayer(props, {\n    data: null,\n    image: props.data,\n    bounds: [props.tile.bbox.west, props.tile.bbox.south, props.tile.bbox.east, props.tile.bbox.north]\n  })\n};\nconst terrainLayerDefaults = {\n  elevationDecoder: {\n    rScaler: 0,\n    gScaler: 0,\n    bScaler: 337,\n    offset: 0\n  },\n  meshMaxError: 1,\n  wrapLongitude: true,\n  workerUrl: \"./terrain-loader.worker.js\",\n  material: {\n    ambient: 0.2,\n    diffuse: 1,\n    shininess: 128,\n    specularColor: [255, 192, 64]\n  }\n};\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      viz: \"bumpy-terrain\",\n      viewState: {\n        longitude: -122.4,\n        latitude: 37.7,\n        zoom: 6,\n        pitch: 45,\n        bearing: 0,\n        maxZoom: 10\n      },\n      isDrone: true,\n      pitchChange: 10\n    };\n  }\n\n  componentDidMount() {\n    this.startAnimating();\n  }\n\n  startAnimating() {\n    window.requestAnimationFrame(() => {\n      const {\n        viewState: {\n          pitch,\n          bearing\n        },\n        pitchChange\n      } = this.state;\n\n      if (typeof pitch !== \"number\" || typeof bearing !== \"number\") {\n        console.log({\n          \"deckgl appearance\": \"loading\",\n          pitch,\n          bearing,\n          pitchChange,\n          time: Date.now()\n        });\n        requestAnimationFrame(() => this.startAnimating());\n      } else {\n        const delta = (bearing % 720 > 360 ? 1 : -1) * pitchChange;\n        console.log(\"starting!\");\n        this.setState({\n          viewState: { ...this.state.viewState,\n            bearing: bearing + 10,\n            pitch: pitch + delta,\n            transitionDuration: 5,\n            onTransitionInterrupt: () => this.setState({\n              isDrone: false\n            }),\n            onTransitionEnd: () => this.startAnimating()\n          }\n        });\n      }\n    });\n  }\n\n  render() {\n    const {\n      viz\n    } = this.state;\n    const smog = new TileLayer({ ...bitmapLayerDefaults,\n      data: './tiles/greys-{z}-{x}-{y}.png',\n      maxZoom: 8,\n      id: 'smog'\n    });\n    const watercolor = new TileLayer({ ...bitmapLayerDefaults,\n      data: './stamen-tiles/watercolor/{z}/{x}/{y}.jpg',\n      id: 'watercolor'\n    });\n    const tonerlabel = new TileLayer({ ...bitmapLayerDefaults,\n      data: './stamen-tiles/toner-labels/{z}/{x}/{y}.png',\n      id: 'tonerlabel'\n    });\n    const terrain = new TileLayer({ ...bitmapLayerDefaults,\n      data: './stamen-tiles/terrain/{z}/{x}/{y}.png',\n      id: 'greenhills'\n    });\n    const bumpyLight = new TerrainLayer({ ...terrainLayerDefaults,\n      id: 'bumpyLight',\n      elevationData: './tiles/globe-{z}-{x}-{y}.png',\n      texture: './tiles/globe-{z}-{x}-{y}.png',\n      workerUrl: \"./terrain-loader.worker.js\"\n    });\n    const bumpyTerrain = new TerrainLayer({ ...terrainLayerDefaults,\n      id: 'bumpyTerrain',\n      elevationData: './tiles/globe-{z}-{x}-{y}.png',\n      texture: './stamen-tiles/terrain/{z}/{x}/{y}.png'\n    });\n    const bumpyWatercolor = new TerrainLayer({ ...terrainLayerDefaults,\n      id: 'bumpyWatercolor',\n      elevationData: './tiles/globe-{z}-{x}-{y}.png',\n      texture: './stamen-tiles/watercolor/{z}/{x}/{y}.jpg'\n    });\n    const layerMapping = {\n      \"bumpy-light\": [bumpyLight],\n      \"bumpy-terrain\": [bumpyTerrain],\n      \"bumpy-watercolor\": [bumpyWatercolor],\n      \"hazy-terrain\": [terrain, smog],\n      \"hazy-watercolor\": [watercolor, tonerlabel, smog],\n      \"hazy-gouache\": [watercolor, smog]\n    };\n    const layers = layerMapping[viz];\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(DeckGL, {\n      viewState: this.state.viewState,\n      controller: true,\n      layers: layers,\n      id: \"maincanvas\",\n      onViewStateChange: ({\n        viewState\n      }) => this.setState({\n        viewState\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"tweaks\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"colophon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 11\n      }\n    }, \"\\xA9 Lee Butterman 2020. Made in Oakland, California.\", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 80\n      }\n    }), \"Map tiles by Stamen Design under \", /*#__PURE__*/React.createElement(\"a\", {\n      href: \"https://creativecommons.org/licenses/by/3.0/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 118\n      }\n    }, \"CC BY 3.0\"), \". Map data by OpenStreetMap under \", /*#__PURE__*/React.createElement(\"a\", {\n      href: \"https://creativecommons.org/licenses/by-sa/3.0/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 220\n      }\n    }, \"CC BY SA 3.0\")), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"tweaks\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 11\n      }\n    }, \"View light pollution as:\", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 37\n      }\n    }), /*#__PURE__*/React.createElement(\"form\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"viz\",\n      value: \"bumpy-light\",\n      checked: viz === \"bumpy-light\",\n      onChange: e => this.setState({\n        viz: e.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 19\n      }\n    }), \"topography, on a white/blue world\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"viz\",\n      value: \"bumpy-terrain\",\n      checked: viz === \"bumpy-terrain\",\n      onChange: e => this.setState({\n        viz: e.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 19\n      }\n    }), \"topography, on a terrain map world\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"viz\",\n      value: \"bumpy-watercolor\",\n      checked: viz === \"bumpy-watercolor\",\n      onChange: e => this.setState({\n        viz: e.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 19\n      }\n    }), \"topography, on a watercolor world\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"viz\",\n      value: \"hazy-terrain\",\n      checked: viz === \"hazy-terrain\",\n      onChange: e => this.setState({\n        viz: e.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 19\n      }\n    }), \"haze, on a terrain map world\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"viz\",\n      value: \"hazy-watercolor\",\n      checked: viz === \"hazy-watercolor\",\n      onChange: e => this.setState({\n        viz: e.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 19\n      }\n    }), \"haze, on a watercolor world with labels\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"viz\",\n      value: \"hazy-gouache\",\n      checked: viz === \"hazy-gouache\",\n      onChange: e => this.setState({\n        viz: e.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 19\n      }\n    }), \"haze, on a watercolor world\"))), /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"checkbox\",\n      checked: this.state.isDrone,\n      onChange: e => this.setState({\n        isDrone: e.target.checked\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 15\n      }\n    }), \"drone hover\"))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/lsb/wikidatageo/dark-sky-vacations/src/App.js"],"names":["React","DeckGL","TerrainLayer","TileLayer","BitmapLayer","bitmapLayerDefaults","wrapLongitude","renderSubLayers","props","data","image","bounds","tile","bbox","west","south","east","north","terrainLayerDefaults","elevationDecoder","rScaler","gScaler","bScaler","offset","meshMaxError","workerUrl","material","ambient","diffuse","shininess","specularColor","App","Component","constructor","state","viz","viewState","longitude","latitude","zoom","pitch","bearing","maxZoom","isDrone","pitchChange","componentDidMount","startAnimating","window","requestAnimationFrame","console","log","time","Date","now","delta","setState","transitionDuration","onTransitionInterrupt","onTransitionEnd","render","smog","id","watercolor","tonerlabel","terrain","bumpyLight","elevationData","texture","bumpyTerrain","bumpyWatercolor","layerMapping","layers","e","target","value","checked"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './App.css';\nimport DeckGL from '@deck.gl/react';\nimport { TerrainLayer, TileLayer, } from '@deck.gl/geo-layers';\nimport { BitmapLayer,  } from '@deck.gl/layers';\n\nconst bitmapLayerDefaults = ({\n  wrapLongitude: true,\n  renderSubLayers: props => (\n    new BitmapLayer((props), {\n      data: null,\n      image: props.data,\n      bounds: [props.tile.bbox.west, props.tile.bbox.south, props.tile.bbox.east, props.tile.bbox.north],\n    })\n  ),\n})\nconst terrainLayerDefaults = ({\n  elevationDecoder: {\n    rScaler: 0,\n    gScaler: 0,\n    bScaler: 337,\n    offset: 0,\n  },\n  meshMaxError: 1,\n  wrapLongitude: true,\n  workerUrl: \"./terrain-loader.worker.js\",\n  material: {\n    ambient: 0.2,\n    diffuse: 1,\n    shininess: 128,\n    specularColor: [255, 192, 64]\n  },\n});\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      viz: \"bumpy-terrain\",\n      viewState: {longitude: -122.4, latitude: 37.7, zoom: 6, pitch: 45, bearing: 0, maxZoom: 10},\n      isDrone: true,\n      pitchChange: 10,\n    };\n  }\n  componentDidMount() {\n    this.startAnimating();\n  }\n  startAnimating() {\n    window.requestAnimationFrame(() => {\n      const {viewState: {pitch, bearing}, pitchChange} = this.state;\n      if((typeof pitch) !== \"number\" || (typeof bearing) !== \"number\") {\n        console.log({\"deckgl appearance\": \"loading\", pitch, bearing, pitchChange, time: Date.now()})\n        requestAnimationFrame(() => this.startAnimating());\n      } else {\n        const delta = (bearing % 720 > 360 ? 1 : -1) * pitchChange;\n        console.log(\"starting!\")\n        this.setState({\n          viewState: {\n            ...this.state.viewState,\n            bearing: bearing + 10,\n            pitch: pitch + delta,\n            transitionDuration: 5,\n            onTransitionInterrupt: () => this.setState({isDrone: false}),\n            onTransitionEnd: () => this.startAnimating(),\n          }\n        })  \n      }\n    })\n  }\n  render() {\n    const {viz} = this.state;\n    const smog = new TileLayer({\n      ...bitmapLayerDefaults,\n      data: './tiles/greys-{z}-{x}-{y}.png',\n      maxZoom: 8,\n      id: 'smog',\n    })\n    const watercolor = new TileLayer({\n      ...bitmapLayerDefaults,\n      data: './stamen-tiles/watercolor/{z}/{x}/{y}.jpg',\n      id: 'watercolor',\n    });\n    const tonerlabel = new TileLayer({\n      ...bitmapLayerDefaults,\n      data: './stamen-tiles/toner-labels/{z}/{x}/{y}.png',\n      id: 'tonerlabel',\n    });\n    const terrain = new TileLayer({\n      ...bitmapLayerDefaults,\n      data: './stamen-tiles/terrain/{z}/{x}/{y}.png',\n      id: 'greenhills',\n    })\n    const bumpyLight = new TerrainLayer({\n      ...terrainLayerDefaults,\n      id: 'bumpyLight',\n      elevationData: './tiles/globe-{z}-{x}-{y}.png',\n      texture: './tiles/globe-{z}-{x}-{y}.png',\n      workerUrl: \"./terrain-loader.worker.js\",\n    });\n    const bumpyTerrain = new TerrainLayer({\n      ...terrainLayerDefaults,\n      id: 'bumpyTerrain',\n      elevationData: './tiles/globe-{z}-{x}-{y}.png',\n      texture: './stamen-tiles/terrain/{z}/{x}/{y}.png',\n    });\n    const bumpyWatercolor = new TerrainLayer({\n      ...terrainLayerDefaults,\n      id: 'bumpyWatercolor',\n      elevationData: './tiles/globe-{z}-{x}-{y}.png',\n      texture: './stamen-tiles/watercolor/{z}/{x}/{y}.jpg',\n    })\n    const layerMapping = ({\n      \"bumpy-light\": [bumpyLight],\n      \"bumpy-terrain\": [bumpyTerrain],\n      \"bumpy-watercolor\": [bumpyWatercolor],\n      \"hazy-terrain\": [terrain, smog],\n      \"hazy-watercolor\": [watercolor, tonerlabel, smog],\n      \"hazy-gouache\": [watercolor, smog],\n    })\n    const layers = layerMapping[viz];\n    return (\n      <div>\n        <div>\n          <DeckGL viewState={this.state.viewState} controller={true} layers={layers} id={\"maincanvas\"} onViewStateChange={({viewState}) => this.setState({viewState})} />\n        </div>\n        <div className=\"tweaks\">\n          <div id=\"colophon\">© Lee Butterman 2020. Made in Oakland, California.<br/>Map tiles by Stamen Design under <a href=\"https://creativecommons.org/licenses/by/3.0/\">CC BY 3.0</a>. Map data by OpenStreetMap under <a href=\"https://creativecommons.org/licenses/by-sa/3.0/\">CC BY SA 3.0</a></div>\n          <div id=\"tweaks\">\n            View light pollution as:<br/>\n            <form>\n              <div>\n                <label>\n                  <input type=\"radio\" name=\"viz\" value=\"bumpy-light\" checked={viz === \"bumpy-light\"} onChange={e => this.setState({viz: e.target.value})} />\n                  topography, on a white/blue world\n                </label>\n              </div>\n              <div>\n                <label>\n                  <input type=\"radio\" name=\"viz\" value=\"bumpy-terrain\" checked={viz === \"bumpy-terrain\"} onChange={e => this.setState({viz: e.target.value})} />\n                  topography, on a terrain map world\n                </label>\n              </div>\n              <div>\n                <label>\n                  <input type=\"radio\" name=\"viz\" value=\"bumpy-watercolor\" checked={viz === \"bumpy-watercolor\"} onChange={e => this.setState({viz: e.target.value})} />\n                  topography, on a watercolor world\n                </label>\n              </div>\n              <div>\n                <label>\n                  <input type=\"radio\" name=\"viz\" value=\"hazy-terrain\" checked={viz === \"hazy-terrain\"} onChange={e => this.setState({viz: e.target.value})} />\n                  haze, on a terrain map world\n                </label>\n              </div>\n              <div>\n                <label>\n                  <input type=\"radio\" name=\"viz\" value=\"hazy-watercolor\" checked={viz === \"hazy-watercolor\"} onChange={e => this.setState({viz: e.target.value})} />\n                  haze, on a watercolor world with labels\n                </label>\n              </div>\n              <div>\n                <label>\n                  <input type=\"radio\" name=\"viz\" value=\"hazy-gouache\" checked={viz === \"hazy-gouache\"} onChange={e => this.setState({viz: e.target.value})} />\n                  haze, on a watercolor world\n                </label>\n              </div>\n            </form>\n            <label>\n              <input type=\"checkbox\" checked={this.state.isDrone} onChange={e => this.setState({isDrone: e.target.checked})} />\n              drone hover\n            </label>\n          </div>          \n        </div>\n      </div>\n    )\n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}