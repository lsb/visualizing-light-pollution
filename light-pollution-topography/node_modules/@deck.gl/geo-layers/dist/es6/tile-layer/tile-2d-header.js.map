{"version":3,"sources":["../../../src/tile-layer/tile-2d-header.js"],"names":["log","Tile2DHeader","constructor","x","y","z","onTileLoad","onTileError","isVisible","parent","children","content","_isLoaded","data","_loader","isLoaded","byteLength","result","Number","isFinite","error","loadData","getTileData","bbox","Promise","resolve","then","buffers","catch","err"],"mappings":"AAAA,SAAQA,GAAR,QAAkB,eAAlB;AAEA,eAAe,MAAMC,YAAN,CAAmB;AAChCC,EAAAA,WAAW,CAAC;AAACC,IAAAA,CAAD;AAAIC,IAAAA,CAAJ;AAAOC,IAAAA,CAAP;AAAUC,IAAAA,UAAV;AAAsBC,IAAAA;AAAtB,GAAD,EAAqC;AAC9C,SAAKJ,CAAL,GAASA,CAAT;AACA,SAAKC,CAAL,GAASA,CAAT;AACA,SAAKC,CAAL,GAASA,CAAT;AACA,SAAKG,SAAL,GAAiB,KAAjB;AACA,SAAKC,MAAL,GAAc,IAAd;AACA,SAAKC,QAAL,GAAgB,EAAhB;AAEA,SAAKC,OAAL,GAAe,IAAf;AACA,SAAKC,SAAL,GAAiB,KAAjB;AAEA,SAAKN,UAAL,GAAkBA,UAAlB;AACA,SAAKC,WAAL,GAAmBA,WAAnB;AACD;;AAED,MAAIM,IAAJ,GAAW;AACT,WAAO,KAAKD,SAAL,GAAiB,KAAKD,OAAtB,GAAgC,KAAKG,OAA5C;AACD;;AAED,MAAIC,QAAJ,GAAe;AACb,WAAO,KAAKH,SAAZ;AACD;;AAED,MAAII,UAAJ,GAAiB;AACf,UAAMC,MAAM,GAAG,KAAKN,OAAL,GAAe,KAAKA,OAAL,CAAaK,UAA5B,GAAyC,CAAxD;;AACA,QAAI,CAACE,MAAM,CAACC,QAAP,CAAgBF,MAAhB,CAAL,EAA8B;AAC5BjB,MAAAA,GAAG,CAACoB,KAAJ,CAAU,qCAAV;AACD;;AACD,WAAOH,MAAP;AACD;;AAEDI,EAAAA,QAAQ,CAACC,WAAD,EAAc;AACpB,UAAM;AAACnB,MAAAA,CAAD;AAAIC,MAAAA,CAAJ;AAAOC,MAAAA,CAAP;AAAUkB,MAAAA;AAAV,QAAkB,IAAxB;;AACA,QAAI,CAACD,WAAL,EAAkB;AAChB;AACD;;AAED,SAAKR,OAAL,GAAeU,OAAO,CAACC,OAAR,CAAgBH,WAAW,CAAC;AAACnB,MAAAA,CAAD;AAAIC,MAAAA,CAAJ;AAAOC,MAAAA,CAAP;AAAUkB,MAAAA;AAAV,KAAD,CAA3B,EACZG,IADY,CACPC,OAAO,IAAI;AACf,WAAKhB,OAAL,GAAegB,OAAf;AACA,WAAKf,SAAL,GAAiB,IAAjB;AACA,WAAKN,UAAL,CAAgB,IAAhB;AACA,aAAOqB,OAAP;AACD,KANY,EAOZC,KAPY,CAONC,GAAG,IAAI;AACZ,WAAKjB,SAAL,GAAiB,IAAjB;AACA,WAAKL,WAAL,CAAiBsB,GAAjB;AACD,KAVY,CAAf;AAWD;;AAjD+B","sourcesContent":["import {log} from '@deck.gl/core';\n\nexport default class Tile2DHeader {\n  constructor({x, y, z, onTileLoad, onTileError}) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n    this.isVisible = false;\n    this.parent = null;\n    this.children = [];\n\n    this.content = null;\n    this._isLoaded = false;\n\n    this.onTileLoad = onTileLoad;\n    this.onTileError = onTileError;\n  }\n\n  get data() {\n    return this._isLoaded ? this.content : this._loader;\n  }\n\n  get isLoaded() {\n    return this._isLoaded;\n  }\n\n  get byteLength() {\n    const result = this.content ? this.content.byteLength : 0;\n    if (!Number.isFinite(result)) {\n      log.error('byteLength not defined in tile data')();\n    }\n    return result;\n  }\n\n  loadData(getTileData) {\n    const {x, y, z, bbox} = this;\n    if (!getTileData) {\n      return;\n    }\n\n    this._loader = Promise.resolve(getTileData({x, y, z, bbox}))\n      .then(buffers => {\n        this.content = buffers;\n        this._isLoaded = true;\n        this.onTileLoad(this);\n        return buffers;\n      })\n      .catch(err => {\n        this._isLoaded = true;\n        this.onTileError(err);\n      });\n  }\n}\n"],"file":"tile-2d-header.js"}