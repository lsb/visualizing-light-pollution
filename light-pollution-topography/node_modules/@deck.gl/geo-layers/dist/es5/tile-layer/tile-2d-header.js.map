{"version":3,"sources":["../../../src/tile-layer/tile-2d-header.js"],"names":["Tile2DHeader","x","y","z","onTileLoad","onTileError","isVisible","parent","children","content","_isLoaded","getTileData","bbox","_loader","Promise","resolve","then","buffers","err","result","byteLength","Number","isFinite","log","error"],"mappings":";;;;;;;;;;;;;AAAA;;IAEqBA,Y;AACnB,8BAAgD;AAAA,QAAnCC,CAAmC,QAAnCA,CAAmC;AAAA,QAAhCC,CAAgC,QAAhCA,CAAgC;AAAA,QAA7BC,CAA6B,QAA7BA,CAA6B;AAAA,QAA1BC,UAA0B,QAA1BA,UAA0B;AAAA,QAAdC,WAAc,QAAdA,WAAc;AAAA;AAC9C,SAAKJ,CAAL,GAASA,CAAT;AACA,SAAKC,CAAL,GAASA,CAAT;AACA,SAAKC,CAAL,GAASA,CAAT;AACA,SAAKG,SAAL,GAAiB,KAAjB;AACA,SAAKC,MAAL,GAAc,IAAd;AACA,SAAKC,QAAL,GAAgB,EAAhB;AAEA,SAAKC,OAAL,GAAe,IAAf;AACA,SAAKC,SAAL,GAAiB,KAAjB;AAEA,SAAKN,UAAL,GAAkBA,UAAlB;AACA,SAAKC,WAAL,GAAmBA,WAAnB;AACD;;;;6BAkBQM,W,EAAa;AAAA;;AAAA,UACbV,CADa,GACI,IADJ,CACbA,CADa;AAAA,UACVC,CADU,GACI,IADJ,CACVA,CADU;AAAA,UACPC,CADO,GACI,IADJ,CACPA,CADO;AAAA,UACJS,IADI,GACI,IADJ,CACJA,IADI;;AAEpB,UAAI,CAACD,WAAL,EAAkB;AAChB;AACD;;AAED,WAAKE,OAAL,GAAeC,OAAO,CAACC,OAAR,CAAgBJ,WAAW,CAAC;AAACV,QAAAA,CAAC,EAADA,CAAD;AAAIC,QAAAA,CAAC,EAADA,CAAJ;AAAOC,QAAAA,CAAC,EAADA,CAAP;AAAUS,QAAAA,IAAI,EAAJA;AAAV,OAAD,CAA3B,EACZI,IADY,CACP,UAAAC,OAAO,EAAI;AACf,QAAA,KAAI,CAACR,OAAL,GAAeQ,OAAf;AACA,QAAA,KAAI,CAACP,SAAL,GAAiB,IAAjB;;AACA,QAAA,KAAI,CAACN,UAAL,CAAgB,KAAhB;;AACA,eAAOa,OAAP;AACD,OANY,WAON,UAAAC,GAAG,EAAI;AACZ,QAAA,KAAI,CAACR,SAAL,GAAiB,IAAjB;;AACA,QAAA,KAAI,CAACL,WAAL,CAAiBa,GAAjB;AACD,OAVY,CAAf;AAWD;;;wBAjCU;AACT,aAAO,KAAKR,SAAL,GAAiB,KAAKD,OAAtB,GAAgC,KAAKI,OAA5C;AACD;;;wBAEc;AACb,aAAO,KAAKH,SAAZ;AACD;;;wBAEgB;AACf,UAAMS,MAAM,GAAG,KAAKV,OAAL,GAAe,KAAKA,OAAL,CAAaW,UAA5B,GAAyC,CAAxD;;AACA,UAAI,CAACC,MAAM,CAACC,QAAP,CAAgBH,MAAhB,CAAL,EAA8B;AAC5BI,kBAAIC,KAAJ,CAAU,qCAAV;AACD;;AACD,aAAOL,MAAP;AACD","sourcesContent":["import {log} from '@deck.gl/core';\n\nexport default class Tile2DHeader {\n  constructor({x, y, z, onTileLoad, onTileError}) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n    this.isVisible = false;\n    this.parent = null;\n    this.children = [];\n\n    this.content = null;\n    this._isLoaded = false;\n\n    this.onTileLoad = onTileLoad;\n    this.onTileError = onTileError;\n  }\n\n  get data() {\n    return this._isLoaded ? this.content : this._loader;\n  }\n\n  get isLoaded() {\n    return this._isLoaded;\n  }\n\n  get byteLength() {\n    const result = this.content ? this.content.byteLength : 0;\n    if (!Number.isFinite(result)) {\n      log.error('byteLength not defined in tile data')();\n    }\n    return result;\n  }\n\n  loadData(getTileData) {\n    const {x, y, z, bbox} = this;\n    if (!getTileData) {\n      return;\n    }\n\n    this._loader = Promise.resolve(getTileData({x, y, z, bbox}))\n      .then(buffers => {\n        this.content = buffers;\n        this._isLoaded = true;\n        this.onTileLoad(this);\n        return buffers;\n      })\n      .catch(err => {\n        this._isLoaded = true;\n        this.onTileError(err);\n      });\n  }\n}\n"],"file":"tile-2d-header.js"}